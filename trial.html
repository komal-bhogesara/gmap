<!DOCTYPE html>
<html>

<head>
    <title>Simple Map</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <link rel="stylesheet" type="text/css" href="./style.css" />
    <script src="./index.js"></script>
    <style>
        /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
        #map {
            height: 83%;
            width: 94%;
            margin: auto;
            margin-top: 36px;
        }

        /* Optional: Makes the sample page fill the window. */
        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>
</head>

<body>
    <!-- <button onclick="getLocation()">Try It</button> -->
    <!-- <p id="demo"></p> -->
    <div id="map"></div>
    <script>
        // -----------------------------
        var lati, long;
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition);
            }
        }

        function showPosition(position) {
            lati = position.coords.latitude;
            long = position.coords.longitude;
            // console.log(lati + " " + long);
        }

        //----------------------        
        var map;
        getLocation();
        function initMap() {
            console.log(lati + " " + long);
            map = new google.maps.Map(document.getElementById('map'), {
                // center: { lat: 12.5657, lng: 104.9910 },
                center: {lat: lati, lng: long},
                zoom: 18,
                mapTypeId: google.maps.MapTypeId.SATELITE
            });

            //call marker function
            addMarker({ lat: 19.4575102434422, lng: 72.80425146165518 });
            addMarker({ lat:  19.460137295967158, lng: 72.80041580224146 });
            addMarker({ lat: 19.44828384204169, lng: 72.80756555259649 });
            addMarker({ lat: 19.437231035104244, lng: 72.797847695532 });
            addMarker({ lat: lati, lng: long });

            //add marker function
            function addMarker(coords) {
                var marker = new google.maps.Marker({
                    position: coords,
                    map: map,
                    icon: 'img/mark.png',
                    animation: google.maps.Animation.DROP
                });
            }
        } 
    </script>

    <script>
        function distance(lat1, lon1, lat2, lon2) {
            if ((lat1 == lat2) && (lon1 == lon2)) {
                return 0;
            }
            else {
                var radlat1 = Math.PI * lat1/180;
                var radlat2 = Math.PI * lat2/180;
                var theta = lon1-lon2;
                var radtheta = Math.PI * theta/180;
                var dist = Math.sin(radlat1) * Math.sin(radlat2) + Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);
                if (dist > 1) {
                    dist = 1;
                }
                dist = Math.acos(dist);
                dist = dist * 180/Math.PI;
                dist = dist * 60 * 1.1515;
                dist = dist * 1.609344;
                // console.log("dist is:"+dist);
                return dist;
            }
        }
        console.log(distance(19.4575102434422, 72.80425146165518, 19.437231035104244, 72.797847695532));
    </script>

    <!-- Async script executes immediately and must be after any DOM elements used in callback. -->
    <script
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBMKtZvTui-U1cOBekJkOktFPeKiAgRTmU&callback=initMap&v=weekly"
        async></script>
    <!-- <script async
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBMKtZvTui-U1cOBekJkOktFPeKiAgRTmU&callback=initMap">
        </script> -->
</body>

</html>